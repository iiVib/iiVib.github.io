<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุนุจุฉ ุงูุดุฎุตูุงุช</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- ุดุงุดุฉ ุงูุจุฏุงูุฉ -->
    <div id="startScreen" class="screen active">
        <div class="start-container">
            <div class="start-header">
                <h1>๐ฎ ูุนุจุฉ ุงุฎุชูุงุฑ ุงูุดุฎุตูุงุช</h1>
                <p>ุงูุนุจ ูุน ุฃุตุฏูุงุฆู ุฃูููุงูู</p>
            </div>

            <div class="start-buttons">
                <button class="start-btn create-btn" onclick="createGame()">
                    <span class="btn-icon">๐</span>
                    <span class="btn-text">ุฅูุดุงุก ุบุฑูุฉ ุฌุฏูุฏุฉ</span>
                </button>

                <button class="start-btn join-btn" onclick="showJoinForm()">
                    <span class="btn-icon">๐</span>
                    <span class="btn-text">ุงูุงูุถูุงู ุฅูู ุบุฑูุฉ</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุงูุงูุชุธุงุฑ (ููุดุฆ ุงูุบุฑูุฉ) -->
    <div id="waitingScreen" class="screen">
        <div class="waiting-container">
            <div class="waiting-header">
                <h2>โณ ูู ุงูุชุธุงุฑ ูุงุนุจ ุขุฎุฑ</h2>
            </div>

            <div class="code-section">
                <p class="code-label">ุดุงุฑู ูุฐุง ุงูููุฏ ูุน ุตุฏููู:</p>
                <div class="code-display">
                    <input type="text" id="gameCode" readonly class="code-input">
                    <button class="copy-btn" onclick="copyCode()">๐ ูุณุฎ</button>
                </div>
            </div>

            <div class="player-info">
                <p>ุฃูุช ุงููุงุนุจ ุงูุฃูู ๐ค</p>
                <p id="statusMessage">ูู ุงูุชุธุงุฑ ุงููุงุนุจ ุงูุซุงูู...</p>
            </div>

            <button class="cancel-btn" onclick="goBack()">ุงูุนูุฏุฉ</button>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุงูุงูุถูุงู -->
    <div id="joinScreen" class="screen">
        <div class="join-container">
            <div class="join-header">
                <h2>ุงูุงูุถูุงู ุฅูู ุบุฑูุฉ</h2>
            </div>

            <div class="join-form">
                <input type="text" id="joinCode" placeholder="ุฃุฏุฎู ุงูููุฏ ููุง..." class="code-input">
                <button class="join-btn" onclick="joinGame()">ุงูุงูุถูุงู ๐ฎ</button>
            </div>

            <button class="cancel-btn" onclick="goBack()">ุงูุนูุฏุฉ</button>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุชุญุฏูุฏ ุงูุฏูุฑ -->
    <div id="roleScreen" class="screen">
        <div class="role-container">
            <div class="role-header">
                <h2>ุงุฎุชุฑ ุฏูุฑู ูู ุงููุนุจุฉ</h2>
                <p>ููุฏ ุงูุบุฑูุฉ: <span id="roleGameCode"></span></p>
            </div>

            <div class="role-buttons">
                <button class="role-btn player1-role" onclick="selectRole(1)">
                    <span class="role-emoji">๐ค</span>
                    <span class="role-text">ุงููุงุนุจ ุงูุฃูู</span>
                </button>

                <button class="role-btn player2-role" onclick="selectRole(2)">
                    <span class="role-emoji">๐ฅ</span>
                    <span class="role-text">ุงููุงุนุจ ุงูุซุงูู</span>
                </button>
            </div>

            <button class="cancel-btn" onclick="goBack()">ุงูุนูุฏุฉ</button>
        </div>
    </div>

    <!-- ุดุงุดุฉ ุงููุนุจุฉ ุงูุฑุฆูุณูุฉ -->
    <div id="gameScreen" class="screen">
        <div class="game-header-top">
            <div class="game-info">
                <p id="currentRole"></p>
                <p id="gameCodeDisplay"></p>
            </div>
            <button class="exit-btn" onclick="exitGame()">ุฎุฑูุฌ โ</button>
        </div>

        <div class="container">
            <div class="header">
                <h1>๐ฎ ูุนุจุฉ ุงุฎุชูุงุฑ ุงูุดุฎุตูุงุช</h1>
                <p id="gameStatus">ูู ุงูุชุธุงุฑ ุงููุงุนุจ ุงูุขุฎุฑ...</p>
            </div>

            <div class="game-wrapper">
                <!-- ูุงุฆูุฉ ุงูุดุฎุตูุงุช ุงููุดุชุฑูุฉ -->
                <div class="characters-grid" id="mainGrid"></div>

                <!-- ุงููุงุนุจ ุงูุฃูู -->
                <div class="player-section player1">
                    <div class="player-title">๐ค ุงุฎุชูุงุฑุงุช ุงููุงุนุจ ุงูุฃูู</div>
                    <div class="characters-grid" id="player1Display"></div>
                    <button class="reset-btn" onclick="resetPlayer(1)">ุฅุนุงุฏุฉ ุชุนููู</button>
                </div>

                <!-- ุงููุงุนุจ ุงูุซุงูู -->
                <div class="player-section player2">
                    <div class="player-title">๐ฅ ุงุฎุชูุงุฑุงุช ุงููุงุนุจ ุงูุซุงูู</div>
                    <div class="characters-grid" id="player2Display"></div>
                    <button class="reset-btn" onclick="resetPlayer(2)">ุฅุนุงุฏุฉ ุชุนููู</button>
                </div>
            </div>

            <div class="info">
                <p>โจ ุงุถุบุท ุนูู ุงูุดุฎุตูุฉ ูุชุญุฏูุฏูุง ุฃู ุฅูุบุงุก ุงูุชุญุฏูุฏ - ุงูุชุญุฏูุฏุงุช ุขููุฉ ูุฎุงุตุฉ ุจู!</p>
            </div>
        </div>
    </div>

    <script>
        // ูุชุบูุฑุงุช ุงููุนุจุฉ
        const characters = [
            { name: 'ููุฌูุชุง', image: 'https://via.placeholder.com/120/FF6B6B/FFFFFF?text=Vegeta' },
            { name: 'ุฒูุฑู', image: 'https://via.placeholder.com/120/4ECDC4/FFFFFF?text=Zoro' },
            { name: 'ูููู', image: 'https://via.placeholder.com/120/FFE66D/FFFFFF?text=Luffy' },
            { name: 'ูุงูุงุดู', image: 'https://via.placeholder.com/120/95E1D3/FFFFFF?text=Kakashi' },
            { name: 'ูุงุฏุงุฑุง', image: 'https://via.placeholder.com/120/F38181/FFFFFF?text=Madara' },
            { name: 'ููุณููุง', image: 'https://via.placeholder.com/120/AA96DA/FFFFFF?text=Misoka' },
            { name: 'ูุงูู', image: 'https://via.placeholder.com/120/FCBAD3/FFFFFF?text=Nahi' },
            { name: 'ุจูุฒุฑูู', image: 'https://via.placeholder.com/120/A8E6CF/FFFFFF?text=Berzerk' },
            { name: 'ูุงุฑูุชู', image: 'https://via.placeholder.com/120/FFD3B6/FFFFFF?text=Naruto' },
            { name: 'ุชูุจุงุฑุง', image: 'https://via.placeholder.com/120/FFAAA5/FFFFFF?text=Tsubara' },
            { name: 'ูููุงู', image: 'https://via.placeholder.com/120/FF8B94/FFFFFF?text=Kilai' },
            { name: 'ุฑูุจูู', image: 'https://via.placeholder.com/120/B4A7D6/FFFFFF?text=Robin' }
        ];

        let selectedPlayer1 = new Set();
        let selectedPlayer2 = new Set();
        let currentGameCode = null;
        let currentRole = null;
        let gameStarted = false;

        // ุฏูุงู ุฅุฏุงุฑุฉ ุงูุดุงุดุงุช
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        // ุฅูุดุงุก ูุนุจุฉ ุฌุฏูุฏุฉ
        function createGame() {
            currentGameCode = generateGameCode();
            currentRole = 1;
            document.getElementById('gameCode').value = currentGameCode;
            showScreen('waitingScreen');
            startCodePolling();
        }

        // ุชูููุฏ ููุฏ ุนุดูุงุฆู
        function generateGameCode() {
            return Math.random().toString(36).substring(2, 8).toUpperCase();
        }

        // ูุณุฎ ุงูููุฏ
        function copyCode() {
            const codeInput = document.getElementById('gameCode');
            codeInput.select();
            document.execCommand('copy');
            alert('ุชู ูุณุฎ ุงูููุฏ! ๐');
        }

        // ุนุฑุถ ูููุฐุฌ ุงูุงูุถูุงู
        function showJoinForm() {
            showScreen('joinScreen');
        }

        // ุงูุงูุถูุงู ุฅูู ูุนุจุฉ
        function joinGame() {
            const code = document.getElementById('joinCode').value.trim().toUpperCase();
            if (code.length === 6) {
                currentGameCode = code;
                document.getElementById('roleGameCode').textContent = code;
                showScreen('roleScreen');
            } else {
                alert('ุงูุฑุฌุงุก ุฅุฏุฎุงู ููุฏ ุตุญูุญ (6 ุฃุญุฑู)');
            }
        }

        // ุงุฎุชูุงุฑ ุงูุฏูุฑ
        function selectRole(role) {
            currentRole = role;
            startGame();
        }

        // ุจุฏุก ุงููุนุจุฉ
        function startGame() {
            gameStarted = true;
            document.getElementById('currentRole').textContent = 
                currentRole === 1 ? 'ุฃูุช ุงููุงุนุจ ุงูุฃูู ๐ค' : 'ุฃูุช ุงููุงุนุจ ุงูุซุงูู ๐ฅ';
            document.getElementById('gameCodeDisplay').textContent = 
                `ููุฏ ุงูุบุฑูุฉ: ${currentGameCode}`;
            document.getElementById('gameStatus').textContent = '๐ฎ ุงููุนุจุฉ ุฌุงูุฒุฉ!';
            showScreen('gameScreen');
            initGame();
        }

        // ุงูุนูุฏุฉ ููุดุงุดุฉ ุงูุณุงุจูุฉ
        function goBack() {
            currentGameCode = null;
            currentRole = null;
            selectedPlayer1.clear();
            selectedPlayer2.clear();
            showScreen('startScreen');
            document.getElementById('joinCode').value = '';
        }

        // ุงูุฎุฑูุฌ ูู ุงููุนุจุฉ
        function exitGame() {
            if (confirm('ูู ุชุฑูุฏ ุงูุฎุฑูุฌ ูู ุงููุนุจุฉุ')) {
                goBack();
            }
        }

        // ุจุฏุก ุงุณุชุทูุงุน ุงูููุฏ (ูุญุงูุงุฉ ุงูุชุญูู)
        function startCodePolling() {
            setTimeout(() => {
                document.getElementById('statusMessage').textContent = 'โ ุชู ุงูุงุชุตุงู ุจูุงุนุจ ุขุฎุฑ!';
            }, 3000);
        }

        // ุฏูุงู ุงููุนุจุฉ ุงูุฑุฆูุณูุฉ
        function initGame() {
            renderMainGrid();
        }

        function renderMainGrid() {
            const grid = document.getElementById('mainGrid');
            grid.innerHTML = '';

            characters.forEach((char, index) => {
                const div = document.createElement('div');
                div.className = 'character';

                div.innerHTML = `
                    <img src="${char.image}" alt="${char.name}">
                    <div class="character-name">${char.name}</div>
                `;

                div.onclick = () => {
                    if (currentRole === 1) {
                        if (selectedPlayer1.has(index)) {
                            selectedPlayer1.delete(index);
                        } else {
                            selectedPlayer1.add(index);
                        }
                    }
                    updateDisplay();
                };

                div.oncontextmenu = (e) => {
                    e.preventDefault();
                    if (currentRole === 2) {
                        if (selectedPlayer2.has(index)) {
                            selectedPlayer2.delete(index);
                        } else {
                            selectedPlayer2.add(index);
                        }
                    }
                    updateDisplay();
                };

                grid.appendChild(div);
            });

            updateDisplay();
        }

        function updateDisplay() {
            const mainGrid = document.getElementById('mainGrid');
            mainGrid.querySelectorAll('.character').forEach((char, index) => {
                const player1Selected = selectedPlayer1.has(index);
                const player2Selected = selectedPlayer2.has(index);
                
                if (player1Selected || player2Selected) {
                    char.classList.add('selected');
                } else {
                    char.classList.remove('selected');
                }
            });

            // ุนุฑุถ ุงุฎุชูุงุฑุงุช ุงููุงุนุจ ุงูุฃูู
            const player1Display = document.getElementById('player1Display');
            player1Display.innerHTML = '';
            selectedPlayer1.forEach(index => {
                const char = characters[index];
                const div = document.createElement('div');
                div.className = 'character';
                div.innerHTML = `
                    <img src="${char.image}" alt="${char.name}">
                    <div class="character-name">${char.name}</div>
                `;
                player1Display.appendChild(div);
            });

            // ุนุฑุถ ุงุฎุชูุงุฑุงุช ุงููุงุนุจ ุงูุซุงูู
            const player2Display = document.getElementById('player2Display');
            player2Display.innerHTML = '';
            selectedPlayer2.forEach(index => {
                const char = characters[index];
                const div = document.createElement('div');
                div.className = 'character';
                div.innerHTML = `
                    <img src="${char.image}" alt="${char.name}">
                    <div class="character-name">${char.name}</div>
                `;
                player2Display.appendChild(div);
            });
        }

        function resetPlayer(playerNum) {
            if (playerNum === 1) {
                selectedPlayer1.clear();
            } else {
                selectedPlayer2.clear();
            }
            renderMainGrid();
        }
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø´Ø®ØµÙŠØ§Øª</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Modal Ù„Ù„ØªÙØ§ØµÙŠÙ„ -->
    <div id="detailsModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div class="modal-image">
                <img id="modalImage" src="" alt="">
            </div>
            <div class="modal-text">
                <h2 id="modalName"></h2>
                <p class="details-label">Some Details :</p>
                <p id="modalDetails"></p>
            </div>
        </div>
    </div>

    <div class="game-screen">
        <div class="game-header-top">
            <div class="game-info">
                <p id="currentRole"></p>
                <p id="gameCodeDisplay"></p>
            </div>
            <button class="exit-btn" onclick="exitGame()">Ø®Ø±ÙˆØ¬ âŒ</button>
        </div>

        <div class="container">
            <div class="header">
                <h1>âš¡ Ù„Ø¹Ø¨Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ø®ØµÙŠØ§Øª âš¡</h1>
                <p id="gameStatus">ğŸ® Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø§Ù‡Ø²Ø©!</p>
            </div>

            <div class="game-wrapper">
                <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø®ØµÙŠØ§Øª Ø§Ù„Ù…Ø´ØªØ±ÙƒØ© -->
                <div class="characters-grid" id="mainGrid"></div>

                <!-- Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„ -->
                <div class="player-section player1">
                    <div class="player-title">ğŸ‘¤ Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„</div>
                    <div class="characters-grid" id="player1Display"></div>
                    <button class="reset-btn" onclick="resetPlayer(1)">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
                </div>

                <!-- Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ -->
                <div class="player-section player2">
                    <div class="player-title">ğŸ‘¥ Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ</div>
                    <div class="characters-grid" id="player2Display"></div>
                    <button class="reset-btn" onclick="resetPlayer(2)">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
                </div>
            </div>

            <div class="info">
                <p id="instructionText">âœ¨ Ø§Ø¶ØºØ· ÙŠØ³Ø§Ø±Ø§Ù‹ Ù„ØªØ­Ø¯ÙŠØ¯ | Ø§Ø¶ØºØ· ÙŠÙ…ÙŠÙ†Ø§Ù‹ Ù„Ù„ØªÙØ§ØµÙŠÙ„</p>
            </div>
        </div>
    </div>

    <script>
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
        const characters = [
            { name: 'Yuji Itadori', image: 'images/1.jfif', details: 'ÙˆØ¹Ø§Ø¡ Ø³ÙˆÙƒÙˆÙ†Ø§ ÙˆÙŠÙ…ØªÙ„Ùƒ Ù‚ÙˆØ© Ø¬Ø³Ø¯ÙŠØ© Ù‡Ø§Ø¦Ù„Ø©. / Sukuna\'s vessel with immense physical strength.' },
            { name: 'Megumi Fushiguro', image: 'images/2.jfif', details: 'ÙŠØ³ØªØ®Ø¯Ù… ØªÙ‚Ù†ÙŠØ© "Ø¹Ø´Ø±Ø© Ø¸Ù„Ø§Ù„" Ù„Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø´ÙŠÙƒÙŠØ¬Ø§Ù…ÙŠ. / Uses the "Ten Shadows Technique" to summon Shikigami.' },
            { name: 'Nobara Kugisaki', image: 'images/3.jfif', details: 'Ø³Ø§Ø­Ø±Ø© ØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø·Ø±Ù‚Ø© ÙˆØ§Ù„Ù…Ø³Ø§Ù…ÙŠØ± ÙˆØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø¯Ù…ÙŠØ©. / A sorcerer who uses a hammer, nails, and the Straw Doll Technique.' },
            { name: 'Satoru Gojo', image: 'images/4.jfif', details: 'Ø§Ù„Ø£Ù‚ÙˆÙ‰ØŒ ÙŠÙ…ØªÙ„Ùƒ Ø¹ÙŠÙˆÙ† Ø§Ù„Ø³ØªØ© ÙˆØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù„Ø§Ù†Ù‡Ø§ÙŠØ©. / The strongest, possessing the Six Eyes and Limitless technique.' },
            { name: 'Ryomen Sukuna', image: 'images/5.jfif', details: 'Ù…Ù„Ùƒ Ø§Ù„Ù„Ø¹Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠ ÙˆØ§Ù„Ø£ÙƒØ«Ø± Ø±Ø¹Ø¨Ø§Ù‹. / The legendary and most fearsome King of Curses.' },
            { name: 'Kento Nanami', image: 'images/6.jfif', details: 'Ø³Ø§Ø­Ø± Ù…Ù† Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù†Ø³Ø¨Ø© 7:3. / A Grade 1 sorcerer using the 7:3 Ratio Technique.' },
            { name: 'Maki Zenin', image: 'images/7.jfif', details: 'Ø®Ø¨ÙŠØ±Ø© Ø£Ø³Ù„Ø­Ø© Ù„Ø§ ØªÙ…Ù„Ùƒ Ø·Ø§Ù‚Ø© Ù…Ù„Ø¹ÙˆÙ†Ø© Ù„ÙƒÙ†Ù‡Ø§ ÙˆØ­Ø´ Ø¬Ø³Ø¯ÙŠ. / A weapon expert with no cursed energy but superhuman physical prowess.' },
            { name: 'Toge Inumaki', image: 'images/8.jfif', details: 'ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„ÙƒÙ„Ø§Ù… Ø§Ù„Ù…Ù„Ø¹ÙˆÙ† Ù„Ø¥Ø¬Ø¨Ø§Ø± Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† Ø¹Ù„Ù‰ ØªÙ†ÙÙŠØ° Ø£ÙˆØ§Ù…Ø±Ù‡. / Uses Cursed Speech to force others to obey his commands.' },
            { name: 'Panda', image: 'images/9.jfif', details: 'Ø¬Ø«Ø© Ù…Ù„Ø¹ÙˆÙ†Ø© Ù…ØªØ­ÙˆÙ„Ø© ØªÙ…ØªÙ„Ùƒ Ø«Ù„Ø§Ø« Ø´Ø®ØµÙŠØ§Øª (Ù†ÙˆÙ‰). / An abrupt mutated Cursed Corpse with three personalities (cores).' },
            { name: 'Yuta Okkotsu', image: 'images/10.jfif', details: 'Ø³Ø§Ø­Ø± Ø¯Ø±Ø¬Ø© Ø®Ø§ØµØ© ÙŠÙ…ØªÙ„Ùƒ Ø·Ø§Ù‚Ø© Ù‡Ø§Ø¦Ù„Ø© ÙˆØªØ­Ù…ÙŠÙ‡ "Ø±ÙŠÙƒØ§". / A Special Grade sorcerer with massive energy, protected by "Rika".' },
            { name: 'Suguru Geto', image: 'images/11.jfif', details: 'Ù…Ø³ØªØ®Ø¯Ù… ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ù„Ø¹Ù†Ø§Øª ÙˆØ®ØµÙ… ØºÙˆØ¬Ùˆ Ø§Ù„Ø³Ø§Ø¨Ù‚. / A Cursed Spirit Manipulation user and Gojo\'s former rival.' },
            { name: 'Mahito', image: 'images/12.jfif', details: 'Ù„Ø¹Ù†Ø© ÙˆÙ„Ø¯Øª Ù…Ù† ÙƒØ±Ø§Ù‡ÙŠØ© Ø§Ù„Ø¨Ø´Ø±ØŒ ÙŠØºÙŠØ± Ø´ÙƒÙ„ Ø§Ù„Ø£Ø±ÙˆØ§Ø­. / A curse born from human hatred; he reshapes souls.' },
            { name: 'Jogo', image: 'images/13.jfif', details: 'Ù„Ø¹Ù†Ø© Ø¨Ø±ÙƒØ§Ù†ÙŠØ© Ù‚ÙˆÙŠØ© ØªØ³Ø¹Ù‰ Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø¨Ø´Ø± Ø¨Ø§Ù„Ù„Ø¹Ù†Ø§Øª. / A powerful volcano-based curse seeking to replace humans.' },
            { name: 'Hanami', image: 'images/14.jfif', details: 'Ù„Ø¹Ù†Ø© ØªÙ…Ø«Ù„ Ø§Ù„ØºØ§Ø¨Ø© ÙˆØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ù†Ø¨Ø§ØªØ§Øª ÙÙŠ Ù‚ØªØ§Ù„Ù‡Ø§. / A curse representing the forest, using plants in battle.' },
            { name: 'Dagon', image: 'images/15.jfif', details: 'Ù„Ø¹Ù†Ø© Ø¨Ø¯Ø£Øª ÙƒØ±Ø­Ù… Ù…Ù„Ø¹ÙˆÙ† Ù…Ø§Ø¦ÙŠ Ø«Ù… ØªØ·ÙˆØ±Øª Ù„ÙƒÙŠØ§Ù† Ù‚ÙˆÙŠ. / A curse that started as a water-based womb then evolved.' },
            { name: 'Aoi Todo', image: 'images/16.jfif', details: 'Ø³Ø§Ø­Ø± Ù‚ÙˆÙŠ Ù…Ù† Ù…Ø¯Ø±Ø³Ø© ÙƒÙŠÙˆØªÙˆ ÙŠØ³ØªØ®Ø¯Ù… ØªÙ‚Ù†ÙŠØ© "Ø¨ÙˆØºÙŠ ÙˆÙˆØºÙŠ". / A strong Kyoto student who uses the "Boogie Woogie" technique.' },
            { name: 'Mai Zenin', image: 'images/17.jfif', details: 'Ø£Ø®Øª Ù…Ø§ÙƒÙŠ ÙˆØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³Ø¯Ø³Ø§Øª Ù„ØªØ¹Ø²ÙŠØ² Ø·Ø§Ù‚ØªÙ‡Ø§ Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†Ø©. / Maki\'s sister who uses firearms to channel her cursed energy.' },
            { name: 'Kasumi Miwa', image: 'images/18.jfif', details: 'ØªØµÙ Ù†ÙØ³Ù‡Ø§ Ø¨Ø§Ù„Ø³Ø§Ø­Ø±Ø© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ© ÙˆØªØ³ØªØ®Ø¯Ù… Ø£Ø³Ù„ÙˆØ¨ "Ø§Ù„Ø¸Ù„ Ø§Ù„Ø¨Ø³ÙŠØ·". / Describes herself as ordinary; uses "Simple Shadow" style.' },
            { name: 'Kokichi Muta', image: 'images/19.jfif', details: 'ÙŠØªØ­ÙƒÙ… Ø¨Ø¢Ù„ÙŠÙŠÙ† Ø¹Ù† Ø¨Ø¹Ø¯ Ø¨Ø³Ø¨Ø¨ "Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ø³Ù…Ø§ÙˆÙŠ". / Controls robots remotely due to a "Heavenly Restriction."' },
            { name: 'Noritoshi Kamo', image: 'images/20.jfif', details: 'ÙŠØ³ØªØ®Ø¯Ù… ØªÙ‚Ù†ÙŠØ© Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ø¯Ù… Ø§Ù„Ù…ÙˆØ±ÙˆØ«Ø© ÙÙŠ Ø¹Ø§Ø¦Ù„Ø© ÙƒØ§Ù…Ùˆ. / Uses the Blood Manipulation technique inherited by the Kamo family.' },
            { name: 'Momo Nishimiya', image: 'images/21.jfif', details: 'Ø³Ø§Ø­Ø±Ø© ØªØ·ÙŠØ± Ø¹Ù„Ù‰ Ù…ÙƒÙ†Ø³Ø© ÙˆØªØ³ØªØ®Ø¯Ù… Ø§Ù„Ø±ÙŠØ§Ø­ ÙÙŠ Ø§Ù„Ù‡Ø¬ÙˆÙ…. / A sorcerer who flies on a broom and uses wind attacks.' },
            { name: 'Shoko Ieiri', image: 'images/22.jfif', details: 'Ø§Ù„Ø·Ø¨ÙŠØ¨Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ø³Ø­Ø±Ø© Ø¨ÙØ¶Ù„ ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø¹Ù„Ø§Ø¬ Ø§Ù„Ù…Ø¹ÙƒÙˆØ³Ø©. / The main doctor for sorcerers via Reversed Cursed Technique.' },
            { name: 'Kiyotaka Ijichi', image: 'images/23.jfif', details: 'Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ù„ÙˆØ¬Ø³ØªÙŠØ© ÙˆØ§Ù„Ø­ÙˆØ§Ø¬Ø² ÙÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©. / In charge of logistics and barriers (veils) at the school.' },
            { name: 'Yoshinobu Gakuganji', image: 'images/24.jfif', details: 'Ù…Ø¯ÙŠØ± Ù…Ø¯Ø±Ø³Ø© ÙƒÙŠÙˆØªÙˆ ÙˆÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ ÙƒØ³Ù„Ø§Ø­. / Principal of Kyoto school; uses music as a weapon.' },
            { name: 'Mei Mei', image: 'images/25.jfif', details: 'Ø³Ø§Ø­Ø±Ø© Ù…Ø³ØªÙ‚Ù„Ø© ØªØ­Ø¨ Ø§Ù„Ù…Ø§Ù„ ÙˆØªØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØºØ±Ø¨Ø§Ù†. / An independent sorcerer who loves money and controls crows.' },
            { name: 'Ui Ui', image: 'images/26.jfif', details: 'Ø´Ù‚ÙŠÙ‚ Ù…ÙŠ Ù…ÙŠ Ø§Ù„Ù…Ø®Ù„Øµ Ø¬Ø¯Ø§Ù‹ Ù„Ù‚Ø¯Ø±Ø§ØªÙ‡Ø§. / Mei Mei\'s younger brother, deeply devoted to her.' },
            { name: 'Choso', image: 'images/27.jfif', details: 'Ø§Ù„Ø£Ø® Ø§Ù„Ø£ÙƒØ¨Ø± Ù„Ù„Ø£Ø±Ø­Ø§Ù… Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†Ø© ÙˆÙŠØ³ØªØ®Ø¯Ù… ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø¯Ù…. / The eldest of the Cursed Wombs, using blood techniques.' },
            { name: 'Eso', image: 'images/28.jfif', details: 'Ø£Ø­Ø¯ Ø§Ù„Ø£Ø±Ø­Ø§Ù… Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†Ø© ÙˆÙŠÙ…ØªÙ„Ùƒ ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ø¯Ù… Ø§Ù„Ø³Ø§Ù…. / One of the Cursed Wombs with poisonous blood techniques.' },
            { name: 'Kechizu', image: 'images/29.jfif', details: 'Ø§Ù„Ø£Ø® Ø§Ù„Ø£ØµØºØ± Ù„Ù„Ø£Ø±Ø­Ø§Ù… Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†Ø© Ø¨Ù…Ø¸Ù‡Ø± ØºÙŠØ± Ø¨Ø´Ø±ÙŠ. / The youngest Cursed Womb brother with a non-human appearance.' },
            { name: 'Toji Fushiguro', image: 'images/30.jfif', details: 'Ù‚Ø§ØªÙ„ Ø§Ù„Ø³Ø­Ø±Ø© Ø§Ù„Ø°ÙŠ ÙƒØ§Ø¯ Ø£Ù† ÙŠÙ‚ØªÙ„ ØºÙˆØ¬Ùˆ. / The Sorcerer Killer who nearly defeated Gojo.' },
            { name: 'Naobito Zenin', image: 'images/31.jfif', details: 'Ø±Ø¦ÙŠØ³ Ø¹Ø§Ø¦Ù„Ø© Ø²ÙŠÙ†ÙŠÙ† ÙˆÙŠÙ…ØªØ§Ø² Ø¨Ø³Ø±Ø¹Ø© ÙØ§Ø¦Ù‚Ø© Ø¬Ø¯Ø§Ù‹. / Head of the Zenin family, known for incredible speed.' },
            { name: 'Naoya Zenin', image: 'images/32.jfif', details: 'Ø³Ø§Ø­Ø± Ù…ØºØ±ÙˆØ± ÙŠØ·Ù…Ø­ Ù„Ø±Ø¦Ø§Ø³Ø© Ø¹Ø§Ø¦Ù„ØªÙ‡ ÙˆÙŠÙ…ØªÙ„Ùƒ Ø³Ø±Ø¹Ø© Ø¹Ø§Ù„ÙŠØ©. / An arrogant sorcerer seeking family leadership with high speed.' },
            { name: 'Yuki Tsukumo', image: 'images/33.jfif', details: 'Ø³Ø§Ø­Ø±Ø© Ø¯Ø±Ø¬Ø© Ø®Ø§ØµØ© ØªÙ‡ØªÙ… Ø¨Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¹Ø§Ù„Ù… Ø¨Ù„Ø§ Ù„Ø¹Ù†Ø§Øª. / A Special Grade sorcerer researching a world without curses.' },
            { name: 'Tengen', image: 'images/34.jfif', details: 'ÙƒÙŠØ§Ù† Ø®Ø§Ù„Ø¯ ÙŠÙˆÙØ± Ø§Ù„Ø­Ù…Ø§ÙŠØ© ÙˆØ§Ù„Ø­ÙˆØ§Ø¬Ø² Ù„Ù„ÙŠØ§Ø¨Ø§Ù†. / An immortal being providing protection and barriers for Japan.' },
            { name: 'Masamichi Yaga', image: 'images/35.jfif', details: 'Ù…Ø¯ÙŠØ± Ù…Ø¯Ø±Ø³Ø© Ø·ÙˆÙƒÙŠÙˆ ÙˆØµØ§Ù†Ø¹ Ø§Ù„Ø¬Ø«Ø« Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†Ø©. / Principal of Tokyo school and creator of Cursed Corpses.' },
            { name: 'Arata Nitta', image: 'images/36.jfif', details: 'Ù…Ø³ØªØ®Ø¯Ù… Ø¬ÙˆØ¬ÙŠØªØ³Ùˆ Ù…ØªØ®ØµØµ ÙÙŠ Ø§Ù„Ø¥Ø³Ø¹Ø§ÙØ§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©. / A jujutsu user specialized in medical first aid.' },
            { name: 'Junpei Yoshino', image: 'images/37.jfif', details: 'Ø¶Ø­ÙŠØ© ØªÙ†Ù…Ø± ØªÙˆØ±Ø· Ù…Ø¹ Ù…Ø§Ù‡ÙŠØªÙˆ ÙˆØªØ¹Ù„Ù… ÙÙ†ÙˆÙ† Ø§Ù„Ù„Ø¹Ù†Ø§Øª. / A bullying victim who met Mahito and learned curse arts.' },
            { name: 'Kenjaku', image: 'images/38.jfif', details: 'Ø¹Ù‚Ù„ Ù…Ø¯Ø¨Ø± Ù‚Ø¯ÙŠÙ… ÙŠØ³ØªÙˆÙ„ÙŠ Ø¹Ù„Ù‰ Ø£Ø¬Ø³Ø§Ø¯ Ø§Ù„Ø³Ø­Ø±Ø©. / An ancient mastermind who takes over sorcerers\' bodies.' },
            { name: 'Uraume', image: 'images/39.jfif', details: 'Ø®Ø§Ø¯Ù… Ø³ÙˆÙƒÙˆÙ†Ø§ Ø§Ù„Ù…Ø®Ù„Øµ ÙˆÙŠÙ…ØªÙ„Ùƒ ØªÙ‚Ù†ÙŠØ© ØªØ¬Ù…ÙŠØ¯ Ø§Ù„Ø¬Ù„ÙŠØ¯. / Sukuna\'s loyal servant with ice-freezing techniques.' },
            { name: 'Haruta Shigemo', image: 'images/40.jfif', details: 'Ø¬Ø¨Ø§Ù† ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ "Ø§Ù„Ù…Ø¹Ø¬Ø²Ø§Øª" Ø§Ù„Ù…Ø®Ø²Ù†Ø© Ù„Ù„Ù†Ø¬Ø§Ø©. / A coward relying on stored "miracles" to survive.' },
            { name: 'Juzo Kumiya', image: 'images/41.jfif', details: 'ØµØ§Ù†Ø¹ Ø£Ø¯ÙˆØ§Øª Ù…Ù„Ø¹ÙˆÙ†Ø© ÙŠØ­Ø¨ ØµÙ†Ø¹ Ø£Ø´ÙŠØ§Ø¡ Ù…Ù† Ø£Ø¬Ø³Ø§Ø¯ Ø§Ù„Ø¨Ø´Ø±. / A cursed tool maker who likes crafting items from humans.' },
            { name: 'Jiro Awasaka', image: 'images/42.jfif', details: 'Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¹Ù†Ø§Øª Ø¹Ø¬ÙˆØ² ÙŠÙ…ØªÙ„Ùƒ ØªÙ‚Ù†ÙŠØ© "Ø§Ù„ï¿½ï¿½Ø¶Ø§Ø¯". / An old curse user with the "Inverse" technique.' },
            { name: 'Kinji Hakari', image: 'images/43.jfif', details: 'Ø·Ø§Ù„Ø¨ Ø³Ù†Ø© Ø«Ø§Ù„Ø«Ø© Ù…ÙˆÙ‚ÙˆÙØŒ ÙŠØ¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø¸ ÙˆØ§Ù„Ù‚Ù…Ø§Ø± ÙÙŠ Ù‚ØªØ§Ù„Ù‡. / A suspended 3rd-year student who relies on luck and gambling.' },
            { name: 'Rika Orimoto', image: 'images/44.jfif', details: 'Ø§Ù„Ø±ÙˆØ­ Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†Ø© Ø§Ù„ØªÙŠ ÙƒØ§Ù†Øª ØªØ±Ø§ÙÙ‚ ÙŠÙˆØªØ§ ÙˆØªÙ„Ù‚Ø¨ Ø¨Ø§Ù„Ù…Ù„ÙƒØ©. / The cursed spirit that accompanied Yuta, known as the Queen.' },
            { name: 'Hiromi Higuruma', image: 'images/45.jfif', details: 'Ø¹Ø¨Ù‚Ø±ÙŠ Ù‚Ø§Ù†ÙˆÙ†ÙŠ ÙŠÙ…ØªÙ„Ùƒ ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø­ÙƒÙ…Ø© ÙˆØ§Ù„Ù…Ø·Ø±Ù‚Ø©. / A legal genius with a courtroom and gavel-based technique.' },
            { name: 'Hajime Kashimo', image: 'images/46.jfif', details: 'Ù…Ù‚Ø§ØªÙ„ Ù…Ù† Ø§Ù„Ù…Ø§Ø¶ÙŠ Ø·Ø§Ù‚ØªÙ‡ Ø§Ù„Ù…Ù„Ø¹ÙˆÙ†Ø© ØªØ´Ø¨Ù‡ Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¡. / A fighter from the past whose cursed energy acts like electricity.' },
            { name: 'Ryu Ishigori', image: 'images/47.jfif', details: 'ÙŠÙ…ØªÙ„Ùƒ Ø£Ù‚ÙˆÙ‰ Ù…Ø¯ÙØ¹ Ø·Ø§Ù‚Ø© Ù…Ù„Ø¹ÙˆÙ†Ø© ÙŠØ®Ø±Ø¬ Ù…Ù† Ø´Ø¹Ø±Ù‡. / Has the highest cursed energy output, fired from his hair.' },
            { name: 'Takako Uro', image: 'images/48.jfif', details: 'Ù‚Ø§Ø¦Ø¯Ø© ÙØ±Ù‚Ø© Ø§ØºØªÙŠØ§Ù„Ø§Øª Ø³Ø§Ø¨Ù‚Ø© ØªØªØ­ÙƒÙ… ÙÙŠ "Ø§Ù„ÙØ¶Ø§Ø¡/Ø§Ù„Ø³Ù…Ø§Ø¡". / Former assassination captain who controls "sky/space."' },
            { name: 'Fumihiko Takaba', image: 'images/49.jfif', details: 'ÙŠÙ…ØªÙ„Ùƒ ØªÙ‚Ù†ÙŠØ© ØªØ¬Ø¹Ù„ Ù…Ø§ ÙŠØ¬Ø¯Ù‡ Ù…Ø¶Ø­ÙƒØ§Ù‹ Ø­Ù‚ÙŠÙ‚Ø© ÙˆØ§Ù‚Ø¹Ø©. / Has a technique that makes what he finds funny become reality.' },
            { name: 'Yorozu', image: 'images/50.jfif', details: 'Ø³Ø§Ø­Ø±Ø© Ù…Ù† Ø§Ù„Ù…Ø§Ø¶ÙŠ Ù…Ù‡ÙˆÙˆØ³Ø© Ø¨Ø³ÙˆÙƒÙˆÙ†Ø§ ÙˆØªØ³ØªØ®Ø¯Ù… Ù…Ø¹Ø¯Ù†Ù‹Ø§ Ø³Ø§Ø¦Ù„Ù‹Ø§. / A sorcerer from the past obsessed with Sukuna, using liquid metal.' }
        ];

        let selectedPlayer1 = new Set();
        let selectedPlayer2 = new Set();
        let currentGameCode = null;
        let currentRole = null;
        let syncInterval = null;

        // ÙØªØ­ Modal Ù„Ù„ØªÙØ§ØµÙŠÙ„
        function openModal(character) {
            document.getElementById('modalImage').src = character.image;
            document.getElementById('modalName').textContent = character.name;
            document.getElementById('modalDetails').textContent = character.details;
            document.getElementById('detailsModal').style.display = 'block';
        }

        // Ø¥ØºÙ„Ø§Ù‚ Modal
        function closeModal() {
            document.getElementById('detailsModal').style.display = 'none';
        }

        // Ø¥ØºÙ„Ø§Ù‚ Modal Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø®Ø§Ø±Ø¬Ù‡
        window.onclick = function(event) {
            const modal = document.getElementById('detailsModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        function loadGameData() {
            currentGameCode = sessionStorage.getItem('gameCode');
            currentRole = parseInt(sessionStorage.getItem('playerRole'));

            if (!currentGameCode || !currentRole) {
                alert('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¹ÙˆØ¯Ø© ÙˆØ§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯.');
                window.location.href = 'login.html';
                return;
            }

            const roleText = currentRole === 1 ? 'Ø£Ù†Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„ ğŸ‘¤' : 'Ø£Ù†Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ ğŸ‘¥';
            document.getElementById('currentRole').textContent = roleText;
            document.getElementById('gameCodeDisplay').textContent = `ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©: ${currentGameCode}`;

            if (currentRole === 2) {
                document.getElementById('instructionText').textContent = 'â³ ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„...';
            }

            initGame();
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ†
        function updateFromStorage() {
            const rooms = JSON.parse(localStorage.getItem('activeRooms') || '{}');
            const room = rooms[currentGameCode];
            
            if (room) {
                if (room.player1 && room.player1.selected && currentRole === 2) {
                    selectedPlayer1 = new Set(room.player1.selected);
                    updateDisplay();
                }
                if (room.player2 && room.player2.selected && currentRole === 1) {
                    selectedPlayer2 = new Set(room.player2.selected);
                    updateDisplay();
                }
            }
        }

        // Ø­ÙØ¸ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª
        function saveSelections() {
            const rooms = JSON.parse(localStorage.getItem('activeRooms') || '{}');
            if (!rooms[currentGameCode]) {
                rooms[currentGameCode] = { code: currentGameCode };
            }

            if (currentRole === 1) {
                if (!rooms[currentGameCode].player1) {
                    rooms[currentGameCode].player1 = {};
                }
                rooms[currentGameCode].player1.selected = Array.from(selectedPlayer1);
            } else {
                if (!rooms[currentGameCode].player2) {
                    rooms[currentGameCode].player2 = {};
                }
                rooms[currentGameCode].player2.selected = Array.from(selectedPlayer2);
            }

            localStorage.setItem('activeRooms', JSON.stringify(rooms));
        }

        // Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø©
        function exitGame() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø©ØŸ')) {
                if (syncInterval) {
                    clearInterval(syncInterval);
                }
                const rooms = JSON.parse(localStorage.getItem('activeRooms') || '{}');
                delete rooms[currentGameCode];
                localStorage.setItem('activeRooms', JSON.stringify(rooms));
                sessionStorage.clear();
                window.location.href = 'login.html';
            }
        }

        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©
        function initGame() {
            renderMainGrid();
        }

        function renderMainGrid() {
            const grid = document.getElementById('mainGrid');
            grid.innerHTML = '';

            characters.forEach((char, index) => {
                const div = document.createElement('div');
                div.className = 'character';

                div.innerHTML = `
                    <img src="${char.image}" alt="${char.name}" onerror="this.src='https://via.placeholder.com/120/1a1a2e/FFFFFF?text=${encodeURIComponent(char.name)}'">
                    <div class="character-name">${char.name}</div>
                `;

                // Ø§Ù„Ø¶ØºØ· Ø§Ù„Ø£ÙŠØ³Ø± Ù„Ù„ØªØ­Ø¯ÙŠØ¯
                div.onclick = () => {
                    if (currentRole === 1) {
                        if (selectedPlayer1.has(index)) {
                            selectedPlayer1.delete(index);
                        } else {
                            selectedPlayer1.add(index);
                        }
                        saveSelections();
                    } else if (currentRole === 2) {
                        if (selectedPlayer2.has(index)) {
                            selectedPlayer2.delete(index);
                        } else {
                            selectedPlayer2.add(index);
                        }
                        saveSelections();
                    }
                    updateDisplay();
                };

                // Ø§Ù„Ø¶ØºØ· Ø§Ù„Ø£ÙŠÙ…Ù† Ù„Ù„ØªÙØ§ØµÙŠÙ„
                div.oncontextmenu = (e) => {
                    e.preventDefault();
                    openModal(char);
                };

                grid.appendChild(div);
            });

            updateDisplay();
        }

        function updateDisplay() {
            const mainGrid = document.getElementById('mainGrid');
            mainGrid.querySelectorAll('.character').forEach((char, index) => {
                const isSelected = (currentRole === 1 && selectedPlayer1.has(index)) || 
                                  (currentRole === 2 && selectedPlayer2.has(index));
                
                if (isSelected) {
                    char.classList.add('selected');
                } else {
                    char.classList.remove('selected');
                }
            });

            const player1Display = document.getElementById('player1Display');
            player1Display.innerHTML = '';
            if (currentRole === 1) {
                selectedPlayer1.forEach(index => {
                    const char = characters[index];
                    const div = document.createElement('div');
                    div.className = 'character';
                    div.innerHTML = `
                        <img src="${char.image}" alt="${char.name}" onerror="this.src='https://via.placeholder.com/120/FF3D3D/FFFFFF?text=${encodeURIComponent(char.name)}'">
                        <div class="character-name">${char.name}</div>
                    `;
                    player1Display.appendChild(div);
                });
            }

            const player2Display = document.getElementById('player2Display');
            player2Display.innerHTML = '';
            if (currentRole === 2) {
                selectedPlayer2.forEach(index => {
                    const char = characters[index];
                    const div = document.createElement('div');
                    div.className = 'character';
                    div.innerHTML = `
                        <img src="${char.image}" alt="${char.name}" onerror="this.src='https://via.placeholder.com/120/00D4FF/FFFFFF?text=${encodeURIComponent(char.name)}'">
                        <div class="character-name">${char.name}</div>
                    `;
                    player2Display.appendChild(div);
                });
            }
        }

        function resetPlayer(playerNum) {
            if (playerNum === 1 && currentRole === 1) {
                selectedPlayer1.clear();
                saveSelections();
            } else if (playerNum === 2 && currentRole === 2) {
                selectedPlayer2.clear();
                saveSelections();
            }
            renderMainGrid();
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        loadGameData();

        // ØªØ­Ø¯ÙŠØ« Ø¯ÙˆØ±ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        syncInterval = setInterval(() => {
            updateFromStorage();
        }, 1000);

        // ØªÙ†Ø¸ÙŠÙ Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('beforeunload', () => {
            if (syncInterval) {
                clearInterval(syncInterval);
            }
        });
    </script>
</body>
</html>

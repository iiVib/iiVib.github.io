<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„Ø¹Ø¨Ø© Ø§Ù„Ø´Ø®ØµÙŠØ§Øª</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="game-screen">
        <div class="game-header-top">
            <div class="game-info">
                <p id="currentRole"></p>
                <p id="gameCodeDisplay"></p>
            </div>
            <button class="exit-btn" onclick="exitGame()">Ø®Ø±ÙˆØ¬ âŒ</button>
        </div>

        <div class="container">
            <div class="header">
                <h1>ğŸ® Ù„Ø¹Ø¨Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø´Ø®ØµÙŠØ§Øª</h1>
                <p id="gameStatus">ğŸ® Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¬Ø§Ù‡Ø²Ø©!</p>
            </div>

            <div class="game-wrapper">
                <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø´Ø®ØµÙŠØ§Øª Ø§Ù„Ù…Ø´ØªØ±ÙƒØ© -->
                <div class="characters-grid" id="mainGrid"></div>

                <!-- Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„ -->
                <div class="player-section player1">
                    <div class="player-title">ğŸ‘¤ Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„</div>
                    <div class="characters-grid" id="player1Display"></div>
                    <button class="reset-btn" onclick="resetPlayer(1)">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
                </div>

                <!-- Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ -->
                <div class="player-section player2">
                    <div class="player-title">ğŸ‘¥ Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ</div>
                    <div class="characters-grid" id="player2Display"></div>
                    <button class="reset-btn" onclick="resetPlayer(2)">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
                </div>
            </div>

            <div class="info">
                <p id="instructionText">âœ¨ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù„ØªØ­Ø¯ÙŠØ¯Ù‡Ø§ Ø£Ùˆ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ¯</p>
            </div>
        </div>
    </div>

    <script>
        // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø©
        const characters = [
            { name: 'ÙŠÙˆØ¬ÙŠ Ø¥ÙŠØªØ§Ø¯ÙˆØ±ÙŠ', image: 'data:image/jpeg;base64,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' },
            { name: 'Ù…ÙŠØºÙˆÙ…ÙŠ ÙÙˆØ´ÙŠØºÙˆØ±Ùˆ', image: 'https://i.pinimg.com/564x/b1/5b/4d/b15b4d9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù†ÙˆØ¨Ø§Ø±Ø§ ÙƒØ§ÙƒÙŠØ³Ø§ÙƒÙŠ', image: 'https://i.pinimg.com/564x/c2/6c/5e/c26c5e9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø³Ø§ØªÙˆØ±Ùˆ ØºÙˆØ¬Ùˆ', image: 'https://i.pinimg.com/564x/d3/7d/6f/d37d6f9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø±ÙŠÙˆÙ…ÙŠÙ† Ø³ÙˆÙƒÙˆÙ†Ø§', image: 'https://i.pinimg.com/564x/e4/8e/7a/e48e7a9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ÙƒÙŠÙ†ØªÙˆ Ù†Ø§Ù†Ø§Ù…ÙŠ', image: 'https://i.pinimg.com/564x/f5/9f/8b/f59f8b9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù…Ø§ÙƒÙŠ Ø²ÙŠÙ†ÙŠÙ†', image: 'https://i.pinimg.com/564x/a1/0a/1c/a10a1c9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ØªÙˆÙ…ÙŠ Ø¥ÙŠÙ†ÙˆÙ…Ø§ÙƒÙŠ', image: 'https://i.pinimg.com/564x/b2/1b/2d/b21b2d9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø¨Ø§Ù†Ø¯Ø§', image: 'https://i.pinimg.com/564x/c3/2c/3e/c32c3e9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ÙŠÙˆØªØ§ Ø£ÙˆÙƒÙˆØªØ³Ùˆ', image: 'https://i.pinimg.com/564x/d4/3d/4f/d43d4f9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø³ÙˆØºÙˆØ±Ùˆ ØºÙŠØªÙˆ', image: 'https://i.pinimg.com/564x/e5/4e/5a/e54e5a9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù…Ø§Ù‡ÙŠØªÙˆ', image: 'https://i.pinimg.com/564x/f6/5f/6b/f65f6b9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø¬ÙˆØºÙˆ', image: 'https://i.pinimg.com/564x/a7/6g/7c/a76g7c9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù‡Ø§Ù†Ø§Ù…ÙŠ', image: 'https://i.pinimg.com/564x/b8/7h/8d/b87h8d9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø¯Ø§ØºÙˆÙ†', image: 'https://i.pinimg.com/564x/c9/8i/9e/c98i9e9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø£ÙˆÙŠ ØªÙˆØ¯Ùˆ', image: 'https://i.pinimg.com/564x/d0/9j/af/d09jaf9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù…Ø§ÙŠ Ø²ÙŠÙ†ÙŠÙ†', image: 'https://i.pinimg.com/564x/e1/ak/bg/e1akbg9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ÙƒØ§Ø³ÙˆÙ…ÙŠ Ù…ÙŠÙˆØ§', image: 'https://i.pinimg.com/564x/f2/bl/ch/f2blch9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ÙƒÙˆÙƒÙŠØªØ´ÙŠ Ù…ÙŠÙˆØªØ§', image: 'https://i.pinimg.com/564x/a3/cm/di/a3cmdi9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù†ÙˆØ±ÙŠØªÙˆØ´ÙŠ ÙƒØ§Ù…Ùˆ', image: 'https://i.pinimg.com/564x/b4/dn/ej/b4dnej9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù…ÙˆÙ…Ùˆ Ù†ÙŠØ´ÙŠÙ…ÙŠØ§', image: 'https://i.pinimg.com/564x/c5/eo/fk/c5eofk9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø´ÙˆÙƒÙˆ Ø¥ÙŠØ±ÙŠ', image: 'https://i.pinimg.com/564x/d6/fp/gl/d6fpgl9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ÙƒÙŠÙˆØªØ§ÙƒØ§ Ø¥ÙŠØ¬ÙŠØ´ÙŠ', image: 'https://i.pinimg.com/564x/e7/gq/hm/e7gqhm9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ÙŠÙˆØ´ÙŠÙ†ÙˆØ¨Ùˆ ØºØ§ÙƒØ§Ù†ÙˆØ¬ÙŠ', image: 'https://i.pinimg.com/564x/f8/hr/in/f8hrin9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù…ÙŠ Ù…ÙŠ', image: 'https://i.pinimg.com/564x/a9/is/jo/a9isjo9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø£ÙˆÙŠ Ø£ÙˆÙŠ', image: 'https://i.pinimg.com/564x/ba/jt/kp/bajtĞºp9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ØªØ´ÙˆØ³Ùˆ', image: 'https://i.pinimg.com/564x/cb/ku/lq/cbkulq9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø¥ÙŠØ³Ùˆ', image: 'https://i.pinimg.com/564x/dc/lv/mr/dclvmr9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ÙƒÙŠØªØ´ÙŠØ²Ùˆ', image: 'https://i.pinimg.com/564x/ed/mw/ns/edmwns9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ØªÙˆØ¬ÙŠ ÙÙˆØ´ÙŠØºÙˆØ±Ùˆ', image: 'https://i.pinimg.com/564x/fe/nx/ot/fenxot9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù†Ø§ÙˆØ¨ÙŠØªÙˆ Ø²ÙŠÙ†ÙŠÙ†', image: 'https://i.pinimg.com/564x/af/oy/pu/afoypu9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù†Ø§ÙˆÙŠ Ø²ÙŠÙ†ÙŠÙ†', image: 'https://i.pinimg.com/564x/bg/pz/qv/bgpzqv9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ÙŠÙˆÙƒÙŠ ØªØ³ÙˆÙƒÙˆÙ…Ùˆ', image: 'https://i.pinimg.com/564x/ch/qa/rw/chqarw9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ØªÙŠÙ†ØºÙŠÙ†', image: 'https://i.pinimg.com/564x/di/rb/sx/dirbsx9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù…Ø§Ø³Ø§Ù…ÙŠØªØ´ÙŠ ÙŠØ§ØºØ§', image: 'https://i.pinimg.com/564x/ej/sc/ty/ejscty9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø£ØªØ§ÙƒØ§ Ù†ÙŠØªÙˆ', image: 'https://i.pinimg.com/564x/fk/td/uz/fktduz9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø¬ÙˆÙ†Ø¨ÙŠ ÙŠÙˆØ´ÙŠÙ†Ùˆ', image: 'https://i.pinimg.com/564x/al/ue/va/allueva9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ÙƒÙŠÙ†Ø¬Ø§ÙƒÙˆ', image: 'https://i.pinimg.com/564x/bm/vf/wb/bmvfwb9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø£ÙˆØ±Ø§ÙˆÙ…ÙŠ', image: 'https://i.pinimg.com/564x/cn/wg/xc/cnwgxc9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù‡Ø§Ø±ÙˆØªØ§ Ø´ÙŠØºÙŠÙ…Ùˆ', image: 'https://i.pinimg.com/564x/do/xh/yd/doxhyd9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø¬ÙˆØ²Ùˆ ÙƒÙˆÙ…ÙŠØ§', image: 'https://i.pinimg.com/564x/ep/yi/ze/epyize9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø¬ÙŠØ±Ùˆ Ø£ÙˆØ§Ø³Ø§ÙƒØ§', image: 'https://i.pinimg.com/564x/fq/zj/af/fqzjaf9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø£ÙˆØºØ§Ù…ÙŠ', image: 'https://i.pinimg.com/564x/ar/ak/bg/arakbg9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø±ÙŠÙƒØ§ Ø£ÙˆØ±ÙŠÙ…ÙˆØªÙˆ', image: 'https://i.pinimg.com/564x/bs/bl/ch/bsblch9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù‡ÙŠØ±ÙˆÙ…ÙŠ Ù‡ÙŠØºÙˆØ±ÙˆÙ…Ø§', image: 'https://i.pinimg.com/564x/ct/cm/di/ctcmdi9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ù‡Ø§Ø¬ÙŠÙ…ÙŠ ÙƒØ§Ø´ÙŠÙ…Ùˆ', image: 'https://i.pinimg.com/564x/du/dn/ej/dudnej9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'Ø±ÙŠÙˆ Ø¥ÙŠØ´ÙŠØºÙˆØ±ÙŠ', image: 'https://i.pinimg.com/564x/ev/eo/fk/evfeofk9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ØªØ§ÙƒØ§ÙƒÙˆ Ø£ÙˆØ±Ùˆ', image: 'https://i.pinimg.com/564x/fw/fp/gl/fwfpgl9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ÙÙˆÙ…ÙŠÙ‡ÙŠÙƒÙˆ ØªØ§ÙƒØ§Ø¨Ø§', image: 'https://i.pinimg.com/564x/ax/gq/hm/axgqhm9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' },
            { name: 'ØªØ³ÙˆÙ…ÙŠÙƒÙŠ ÙÙˆØ´ÙŠØºÙˆØ±Ùˆ', image: 'https://i.pinimg.com/564x/by/hr/in/byhrin9e8c4d5e2f1b9a8c7d6e5f4g3h.jpg' }
        ];

        let selectedPlayer1 = new Set();
        let selectedPlayer2 = new Set();
        let currentGameCode = null;
        let currentRole = null;
        let syncInterval = null;

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        function loadGameData() {
            currentGameCode = sessionStorage.getItem('gameCode');
            currentRole = parseInt(sessionStorage.getItem('playerRole'));

            if (!currentGameCode || !currentRole) {
                alert('Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø¹Ø¨Ø© ØºÙŠØ± ØµØ­ÙŠØ­Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¹ÙˆØ¯Ø© ÙˆØ§Ù„Ø¨Ø¯Ø¡ Ù…Ù† Ø¬Ø¯ÙŠØ¯.');
                window.location.href = 'login.html';
                return;
            }

            // Ø¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨
            const roleText = currentRole === 1 ? 'Ø£Ù†Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„ ğŸ‘¤' : 'Ø£Ù†Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ ğŸ‘¥';
            document.getElementById('currentRole').textContent = roleText;
            document.getElementById('gameCodeDisplay').textContent = `ÙƒÙˆØ¯ Ø§Ù„ØºØ±ÙØ©: ${currentGameCode}`;

            // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠØŒ Ø§Ù†ØªØ¸Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„
            if (currentRole === 2) {
                document.getElementById('instructionText').textContent = 'â³ ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„...';
            }

            initGame();
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„ØªØ®Ø²ÙŠÙ†
        function updateFromStorage() {
            const rooms = JSON.parse(localStorage.getItem('activeRooms') || '{}');
            const room = rooms[currentGameCode];
            
            if (room) {
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ù„Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø· (Ø¨Ø¯ÙˆÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©)
                if (room.player1 && room.player1.selected && currentRole === 2) {
                    selectedPlayer1 = new Set(room.player1.selected);
                }
                if (room.player2 && room.player2.selected && currentRole === 1) {
                    selectedPlayer2 = new Set(room.player2.selected);
                }
                updateDisplay();
            }
        }

        // Ø­ÙØ¸ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª
        function saveSelections() {
            const rooms = JSON.parse(localStorage.getItem('activeRooms') || '{}');
            if (!rooms[currentGameCode]) {
                rooms[currentGameCode] = { code: currentGameCode };
            }

            if (currentRole === 1) {
                if (!rooms[currentGameCode].player1) {
                    rooms[currentGameCode].player1 = {};
                }
                rooms[currentGameCode].player1.selected = Array.from(selectedPlayer1);
            } else {
                if (!rooms[currentGameCode].player2) {
                    rooms[currentGameCode].player2 = {};
                }
                rooms[currentGameCode].player2.selected = Array.from(selectedPlayer2);
            }

            localStorage.setItem('activeRooms', JSON.stringify(rooms));
        }

        // Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø©
        function exitGame() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø©ØŸ')) {
                if (syncInterval) {
                    clearInterval(syncInterval);
                }
                const rooms = JSON.parse(localStorage.getItem('activeRooms') || '{}');
                delete rooms[currentGameCode];
                localStorage.setItem('activeRooms', JSON.stringify(rooms));
                sessionStorage.clear();
                window.location.href = 'login.html';
            }
        }

        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù„Ø¹Ø¨Ø©
        function initGame() {
            renderMainGrid();
        }

        function renderMainGrid() {
            const grid = document.getElementById('mainGrid');
            grid.innerHTML = '';

            characters.forEach((char, index) => {
                const div = document.createElement('div');
                div.className = 'character';

                div.innerHTML = `
                    <img src="${char.image}" alt="${char.name}" onerror="this.src='https://via.placeholder.com/120/667eea/FFFFFF?text=${encodeURIComponent(char.name)}'">
                    <div class="character-name">${char.name}</div>
                `;

                div.onclick = () => {
                    if (currentRole === 1) {
                        if (selectedPlayer1.has(index)) {
                            selectedPlayer1.delete(index);
                        } else {
                            selectedPlayer1.add(index);
                        }
                        saveSelections();
                    } else {
                        if (selectedPlayer2.has(index)) {
                            selectedPlayer2.delete(index);
                        } else {
                            selectedPlayer2.add(index);
                        }
                        saveSelections();
                    }
                    updateDisplay();
                };

                grid.appendChild(div);
            });

            updateDisplay();
        }

        function updateDisplay() {
            const mainGrid = document.getElementById('mainGrid');
            mainGrid.querySelectorAll('.character').forEach((char, index) => {
                const player1Selected = selectedPlayer1.has(index);
                const player2Selected = selectedPlayer2.has(index);
                
                if (player1Selected || player2Selected) {
                    char.classList.add('selected');
                } else {
                    char.classList.remove('selected');
                }
            });

            // Ø¹Ø±Ø¶ Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø£ÙˆÙ„ ÙÙ‚Ø·
            const player1Display = document.getElementById('player1Display');
            player1Display.innerHTML = '';
            selectedPlayer1.forEach(index => {
                const char = characters[index];
                const div = document.createElement('div');
                div.className = 'character';
                div.innerHTML = `
                    <img src="${char.image}" alt="${char.name}" onerror="this.src='https://via.placeholder.com/120/FF6B6B/FFFFFF?text=${encodeURIComponent(char.name)}'">
                    <div class="character-name">${char.name}</div>
                `;
                player1Display.appendChild(div);
            });

            // Ø¹Ø±Ø¶ Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø«Ø§Ù†ÙŠ ÙÙ‚Ø·
            const player2Display = document.getElementById('player2Display');
            player2Display.innerHTML = '';
            selectedPlayer2.forEach(index => {
                const char = characters[index];
                const div = document.createElement('div');
                div.className = 'character';
                div.innerHTML = `
                    <img src="${char.image}" alt="${char.name}" onerror="this.src='https://via.placeholder.com/120/4ECDC4/FFFFFF?text=${encodeURIComponent(char.name)}'">
                    <div class="character-name">${char.name}</div>
                `;
                player2Display.appendChild(div);
            });
        }

        function resetPlayer(playerNum) {
            if (playerNum === 1 && currentRole === 1) {
                selectedPlayer1.clear();
                saveSelections();
            } else if (playerNum === 2 && currentRole === 2) {
                selectedPlayer2.clear();
                saveSelections();
            }
            renderMainGrid();
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø¹Ù†Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
        loadGameData();

        // ØªØ­Ø¯ÙŠØ« Ø¯ÙˆØ±ÙŠ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        syncInterval = setInterval(() => {
            updateFromStorage();
        }, 1000);

        // ØªÙ†Ø¸ÙŠÙ Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('beforeunload', () => {
            if (syncInterval) {
                clearInterval(syncInterval);
            }
        });
    </script>
</body>
</html>
